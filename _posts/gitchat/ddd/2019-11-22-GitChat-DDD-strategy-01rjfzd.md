---
layout:      post
classify:    "GitChat"
title:       "领域驱动设计-战略篇之软件复杂度"
subtitle:    "系统全面详尽讲解领域驱动设计"
date:        2019-11-22
catalog:     true
author:      "EidLeung"
tags:
    - GitChat
    - DDD
    - 战略
---

<center><h1><b>软件复杂度</b></h1></center>
<p align="right"><a href="#如何购买">购买专栏</a></p>

## 00. 开篇词
领域驱动设计的本质：领域驱动设计是一个开放的设计方法体系。  
学会对设计的本质思考，不要只限于对设计概念的掌握，而要追求对设计原则与方法的融汇贯通。

## 01. 领域驱动设计概览
### 1. 领域驱动设计概念
1. 领域驱动设计将要解决的业务概念和业务规则转换为软件系统中的类型以及类型的属性与行为，通过合理运用面向对象的封装、继承和多态等设计要素。
2. 领域驱动设计的提出，是设计观念的转变，蕴含了全新的设计思想、设计原则与设计过程。
3. 领域驱动设计建立了以领域为核心驱动力的设计体系

### 2. 领域驱动设计过程
#### 2.1. 战略设计阶段
1. 针对问题域，引入限界上下文（Bounded Context）和上下文映射（Context Map）对问题域进行合理的分解，识别出核心领域（Core Domain）与子领域（SubDomain），并确定领域的边界以及它们之间的关系，维持模型的完整性。
2. 通过分层架构来隔离关注点，尤其是将领域实现独立出来，能够更利于领域模型的单一性与稳定性

#### 2.2. 战术设计阶段
- 领域模型的对象包括：**实体**（Entity）、**值对象**（Value Object）和**领域服务**（Domain Service），领域逻辑都应该封装在这些对象中。避免业务逻辑渗透到领域层之外，导致技术实现与业务逻辑的混淆
- **领域事件**（Domain Event）：在领域驱动设计的演进中，丰富领域模型
- **聚合**（Aggregate）：是一种边界，它可以封装一到多个实体与值对象，并维持该边界范围之内的业务完整性
- **工厂**（Factory）：负责领域对象的创建，往往用于封装复杂或者可能变化的创建逻辑
- **资源库**（Repository）：负责从存放资源的位置（数据库、内存或者其他 Web 资源）获取、添加、删除或者修改领域对象
![战术设计要素之间的关系](/img/gitchat/DDD/ysgx.png)

#### 2.3. 演进的领域驱动设计过程
战略设计阶段和战术设计阶段的设计目标是保持一致的，它们是一个连贯的过程，彼此之间又相互指导与规范，并最终保证一个有效的领域模型和一个富有表达力的实现同时演进。

## 02. 深入分析软件的复杂度
### 1. 什么时候运用领域驱动设计
1. 没有对行为的重用，也没有对业务问题的抽象，每当操作用到业务规则时，都要重复这些业务规则。
2. 快速的原型建立和迭代很快会达到其极限，因为抽象的缺乏限制了重构的选择。
3. 复杂的功能很快会让你无所适从，所以程序的扩展只能是增加简单的应用模块，没有很好的办法来实现更丰富的功能。

### 2. 复杂度的来源
1. **规模**：**软件的需求决定了系统的规模**。当需求增多时，软件系统的规模也会增大，且这种增长趋势并非线性增长，会更加陡峭。
2. **结构**：**决定系统复杂度的关键因素**。结构之所以变得复杂，在多数情况下还是因为系统的质量属性决定的。
3. **变化**：不可预测性带来的复杂度，**变化之难，在于如何平衡**。一方面我们要尽可能地控制变化，至少要将变化产生的影响限制在较小的空间范围内；另一方面又要保证系统不会因为满足可扩展性而变得更加复杂，最后背上过度设计的坏名声。

## 03. 控制复杂度的原则
### 1. 分而治之、控制规模
当把大程序分解成单一目的的小程序，开发会变得很容易。

### 2. 保持结构的清晰与一致
稳定依赖原则，不对变化或易于变化的事物形成依赖

### 3. 拥抱变化
1. 可进化性，可以划分设计单元的边界，以确定每个设计单元应该履行的职责以及需要与其他设计单元协作的接口。
2. 可扩展性，首先要学会识别软件系统中的变化点（热点），常见的变化点包括业务规则、算法策略、外部服务、硬件支持、命令请求、协议标准、数据格式、业务流程、系统配置、界面表现等。
3. 可定制性意味着可以提供特别的功能与服务。

## 04. 应对复杂度（上）
### 1. 需求带来的复杂度：
1. **技术复杂度**来自需求的质量属性
2. **业务复杂度**对应了客户的业务需求*规模*
3. 技术复杂度与业务复杂度并非完全独立，二者混合在一起产生的化合作用更让系统的复杂度变得不可预期，难以掌控

### 2. 面对复杂度及需要面对的问题
1. 问题域过于庞大而复杂，使得从问题域中寻求解决方案的挑战增加，该问题与软件系统的**规模**有关。
2. 开发人员将业务逻辑的复杂度与技术实现的复杂度混淆在一起，该问题与软件系统的**结构**有关。
3. 随着需求的增长和变化，无法控制业务复杂度和技术复杂度，该问题与软件系统的**变化**有关。

### 3. 如何应对
> 要避免业务逻辑的复杂度与技术实现的复杂度混淆在一起，首要任务就是 ==**确定**== 业务逻辑与技术实现的 ==**边界**==，从而**隔离各自的复杂度**。在理想状态下，我们应该保证业务规则与技术实现是正交的。

#### 3.1. 分层架构
分层架构遵循了“关注点分离”原则，
1. 将属于业务逻辑的关注点放到领域层（Domain Layer）中
2. 将支撑业务逻辑的技术实现放到基础设施层（Infrastructure Layer）中。
3. 领域驱动设计又颇具创见的引入了应用层（Application Layer），应用层扮演了双重角色。
   a. 一方面它作为业务逻辑的外观（Facade），暴露了能够体现业务用例的应用服务接
   b. 另一方面它又是业务逻辑与技术实现的粘合剂，实现二者之间的协作。

#### 3.2. 六边形架构
体现业务逻辑的应用层与领域层处于六边形架构的内核，并通过内部的六边形边界与基础设施的模块隔离开。

## 05. 应对复杂度（下）
### 1. 限界上下文（分而治之）
1. 领域分析的过程实际上就是通过对领域的分析而引入限界上下文对问题域进行分解，通过降低规模的方式来降低问题域的复杂度。
2. 通过为模型确定清晰的边界，使得系统的结构变得更加的清晰，从而保证了领域逻辑的一致性。  
3. 将识别出来的限界上下文定义为微服务，并对外公开的服务接口。

### 2. 领域模型（领域知识的抽象）
> 模型是封装，实现了对业务细节的隐藏。  
> 模型是抽象，提取了领域知识的共同特征，保留了面对变化时能够良好扩展的可能性。 

1. 领域模型是对业务需求的一种抽象，其表达了领域概念、领域规则以及领域概念之间的关系。
1. 领域模型是对统一语言的可视化表示，通过它可以减少需求沟通可能出现的歧义。
3. 领域模型通过提炼领域知识，并运用抽象的领域模型去表达，达到对领域逻辑的化繁为简。

---
###### 如何购买
1. 扫描二维码
	<div align="center">
		<a href="http://gitbook.cn/m/mazi/comp/column?columnId=5cdab7fb34b6ed1398fd8de7&sceneId=f52a3810af7511e992061554a506c6dc&utm_source=columninvitecard&utm_campaign=%E9%A2%86%E5%9F%9F%E9%A9%B1%E5%8A%A8%E8%AE%BE%E8%AE%A1%E5%AE%9E%E8%B7%B5%E5%90%88%E8%AE%A2%E7%89%88%EF%BC%88%E6%88%98%E7%95%A5%2B%E6%88%98%E6%9C%AF%EF%BC%89">
			<img src="/img/gitchat/DDD/DDD.jpg" width = "300" height = "300" alt="图片名称" style="display: inline-block"/>
		</a>
		<img src="/img/JTYK.jpg" width = "300" height = "300" alt="今天有课" style="display: inline-block"/>
	</div>
2. 点击链接  
[极客时间-直连](http://gitbook.cn/m/mazi/comp/column?columnId=5cdab7fb34b6ed1398fd8de7&sceneId=f52a3810af7511e992061554a506c6dc&utm_source=columninvitecard&utm_campaign=%E9%A2%86%E5%9F%9F%E9%A9%B1%E5%8A%A8%E8%AE%BE%E8%AE%A1%E5%AE%9E%E8%B7%B5%E5%90%88%E8%AE%A2%E7%89%88%EF%BC%88%E6%88%98%E7%95%A5%2B%E6%88%98%E6%9C%AF%EF%BC%89)  
[今天有课-红包](https://jika.nali.net/youke/coupon/getCouponList?sendUserId=17140)
